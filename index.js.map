{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-function.js","../src/main.js"],"sourcesContent":["const BASE_URL = \"https://pixabay.com/api/\";\n\nexport const pixabayApi = async ({ searchQuery, page = 1, per_page = 15 }) => {\n    const params = new URLSearchParams({\n        key: \"47362908-c1a65ba58d6ddf3afd8961379\",\n        q: searchQuery,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: \"true\",\n        page,\n        per_page\n    });\n\n    try {\n        const response = await fetch(`${BASE_URL}?${params}`);\n        \n        if (!response.ok) {\n            throw new Error(response.statusText);\n        }\n        \n        const data = await response.json();\n        return data;\n    } catch (error) {\n        console.error(error.message);\n    }\n};\n\n\n// export const pixabayApi = (searchQuery, page, per_page) => {\n//     const params = new URLSearchParams({\n//         key: \"47362908-c1a65ba58d6ddf3afd8961379\",\n//         q: searchQuery,\n//         image_type: \"photo\",\n//         orientation: \"horizontal\",\n//         safesearch: \"true\",\n//         page,\n//         per_page: per_page,\n//     })\n\n//     return fetch(`${BASE_URL}?${params}`)\n//         .then((response) => {\n//             if (!response.ok) {\n//                 throw new Error(response.statusText);\n//             }\n//             return response.json();\n//         })\n// }","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nlet box;\n\nexport const createGallery = ({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n    return `<a href=\"${largeImageURL}\" class=\"gallery_item\">\n    <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"gallery__image\" />\n    <div class=\"info\">\n    <p class=\"info-item\"><b>Likes</b> ${likes}</p>\n    <p class=\"info-item\"><b>Views</b> ${views}</p>\n    <p class=\"info-item\"><b>Comments</b> ${comments}</p>\n    <p class=\"info-item\"><b>Downloads</b> ${downloads}</p>\n    </div>\n    </a>`\n}\n\nexport function renderGallery(images) {\n    const gallery = document.querySelector(\".js-gallery\");\n    gallery.insertAdjacentHTML(\"beforeend\", images.map(createGallery).join(\"\"));\n    updateImages()\n}\n\nfunction updateImages() {\n    if (box) {\n        box.refresh();\n    }\n    else {\n        box = new SimpleLightbox('.js-gallery a', {\n            captions: true,\n            captionsData: 'alt',\n            captionDelay: 250,\n        });\n    }\n}\n","import axios from 'axios';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { pixabayApi } from \"./js/pixabay-api.js\"\nimport { createGallery, renderGallery } from \"./js/render-function.js\"\n\nconst searchForm = document.querySelector('.js-search-form');\nconst gallery = document.querySelector(\".js-gallery\")\nconst loader = document.querySelector(\".loader\")\nconst loadMoreBtn = document.querySelector(\".js-load-more\");\n\n\n\nlet page = 1;\nconst per_page = 15;\nlet searchQuery = \"\";\nlet totalPages = 0;\n\nsearchForm.addEventListener(\"submit\", handleSubmit);\nloadMoreBtn.addEventListener(\"click\", handleClickOn)\n\n\nfunction toLoader(show) {\n    if (show) {\n        loader.classList.remove(\"hidden\");\n    }\n    else {\n        loader.classList.add(\"hidden\");\n    }\n};\n\nasync function handleSubmit(event) {\n    event.preventDefault();\n\n    searchQuery = event.target.elements.user_query.value.trim();\n\n    if (!searchQuery) {\n        loadMoreBtn.classList.replace(\"load-more\", \"hidden\")\n        iziToast.error({\n            message: 'Please write smth normal.',\n            position: 'topRight',\n        });\n        return;\n    };\n\n    page = 1;\n    gallery.innerHTML = \"\";\n    loadMoreBtn.classList.replace(\"load-more\", \"hidden\");\n    toLoader(true);\n\n    try {\n        const data = await pixabayApi({searchQuery, page, per_page});\n\n        if (data.total === 0) {\n            iziToast.error({\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n                position: 'topRight',\n            });\n            return;\n        };\n\n        renderGallery(data.hits);\n        totalPages = Math.ceil(data.totalHits / per_page);\n\n        if (page < totalPages) {\n            loadMoreBtn.classList.replace(\"hidden\", \"load-more\");\n        };\n    }\n    catch (error) {\n        iziToast.error({\n            message: 'Failed to fetch images. Please try again later.',\n            position: 'topRight',\n        });\n    } finally {\n        toLoader(false);\n    }\n\n    event.target.elements.user_query.value = \"\";\n}\n\nasync function handleClickOn() {\n    page++;\n\n    loadMoreBtn.disabled = true;\n\n    try {\n        const data = await pixabayApi({searchQuery, page, per_page});\n        renderGallery(data.hits);\n        \n        if (page >= totalPages) {\n            loadMoreBtn.classList.replace(\"load-more\", \"hidden\")\n            iziToast.info({\n            message: \"We're sorry, but you've reached the end of search results.\",\n            position: 'topRight',\n        });\n        }\n\n\n        const card = document.querySelector(\".gallery_item\");\n        const cardHeight = card.getBoundingClientRect().height;\n\n        window.scrollBy({\n            left: 0,\n            top: cardHeight * 2,\n            behavior: \"smooth\",\n        })\n        \n    }\n    catch (error) {\n        iziToast.error({\n            message: 'Failed to load more images. Please try again later.',\n            position: 'topRight',\n        });\n    }\n    finally {\n        loadMoreBtn.disabled = false;\n    }\n}\n"],"names":["BASE_URL","pixabayApi","searchQuery","page","per_page","params","response","error","box","createGallery","webformatURL","largeImageURL","tags","likes","views","comments","downloads","renderGallery","images","updateImages","SimpleLightbox","searchForm","gallery","loader","loadMoreBtn","totalPages","handleSubmit","handleClickOn","toLoader","show","event","iziToast","data","cardHeight"],"mappings":"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"}